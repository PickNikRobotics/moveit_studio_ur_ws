<?xml version='1.0' encoding='UTF-8'?>
<root BTCPP_format="4" main_tree_to_execute="Grab object">
  <!--//////////-->
  <BehaviorTree ID="Grab object" _description="" _favorite="true">
    <Control ID="Sequence" name="TopLevelSequence">
      <Action ID="GetPointCloud" topic_name="/wrist_camera/points"/>
      <Action ID="BetterSendpointcloudtoui" sensor_name="world"/>
      <Action ID="GetPointsFromUser" point_prompts="Select object" view_name="/wrist_camera/color"/>
      <Action ID="GetSyncedImageAndPointCloud" point_cloud="{clicked_point_cloud}" rgb_camera_info_topic_name="/wrist_camera/camera_info" rgb_image_topic_name="/wrist_camera/color" point_cloud_topic_name="/wrist_camera/points"/>
      <Action ID="GetPoseFromPixelCoords" point_cloud="{clicked_point_cloud}"/>
      <Action ID="AdjustPoseWithIMarker" initial_poses="{output_poses}" prompts="Adjust grasp pose"/>
      <Decorator ID="ForEachPoseStamped" vector_in="{adjusted_poses}">
        <Control ID="Sequence">
          <Action ID="InitializeMTCTask" task_id="move_to_pose" controller_names="/joint_trajectory_controller" task="{move_to_pose_task}"/>
          <Action ID="SetupMTCCurrentState" task="{move_to_pose_task}"/>
          <Action ID="SetupMTCMoveToPose" ik_frame="grasp_link" planning_group_name="manipulator" target_pose="{pose}" task="{move_to_pose_task}" use_all_planners="false"/>
          <Action ID="PlanMTCTask" solution="{move_to_pose_solution}" task="{move_to_pose_task}"/>
          <SubTree ID="Wait for Trajectory Approval if User Available" solution="{move_to_pose_solution}"/>
          <Action ID="ExecuteMTCTask" solution="{move_to_pose_solution}"/>
        </Control>
      </Decorator>
    </Control>
  </BehaviorTree>
</root>
